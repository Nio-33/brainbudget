<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BrainBudget Charts - ADHD-Friendly Spending Visualizations</title>
    
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- BrainBudget Styles -->
    <link rel="stylesheet" href="../static/css/charts.css">
    
    <!-- Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="charts-container">
        <!-- Page Header -->
        <header style="text-align: center; margin-bottom: 2rem;">
            <h1 style="font-size: 2rem; color: var(--color-text-primary); margin-bottom: 0.5rem;">
                🧠💰 BrainBudget Charts
            </h1>
            <p style="font-size: 1rem; color: var(--color-text-secondary); max-width: 600px; margin: 0 auto;">
                ADHD-friendly spending visualizations designed to reduce cognitive load and provide clear, actionable insights.
            </p>
        </header>

        <!-- Chart Controls -->
        <div class="chart-controls" style="margin-bottom: 2rem;">
            <div class="chart-control-group">
                <label for="date-range-filter" class="chart-control-label">📅 Date Range</label>
                <select id="date-range-filter" class="chart-control-input">
                    <option value="all">All Time</option>
                    <option value="last-30-days">Last 30 Days</option>
                    <option value="last-90-days">Last 90 Days</option>
                    <option value="this-year">This Year</option>
                    <option value="last-year">Last Year</option>
                </select>
            </div>
            
            <div class="chart-control-group">
                <label for="category-filter" class="chart-control-label">🏷️ Categories</label>
                <select id="category-filter" class="chart-control-input" multiple>
                    <option value="food">Food & Dining</option>
                    <option value="transport">Transportation</option>
                    <option value="entertainment">Entertainment</option>
                    <option value="bills">Bills & Utilities</option>
                    <option value="shopping">Shopping</option>
                    <option value="healthcare">Healthcare</option>
                </select>
            </div>
            
            <div class="chart-control-group" style="justify-content: flex-end; flex-direction: row; align-items: flex-end;">
                <button id="export-charts" class="export-button">
                    📸 Export Charts
                </button>
            </div>
        </div>

        <!-- Spending Categories Donut Chart -->
        <div class="chart-container">
            <h2 class="chart-title">
                <span class="chart-title-icon">🍰</span>
                Spending by Category
            </h2>
            
            <!-- Loading Skeleton -->
            <div id="category-chart-skeleton" class="skeleton skeleton-chart" style="display: none;" 
                 aria-label="Loading spending categories chart"></div>
            
            <!-- Chart Canvas -->
            <div style="position: relative; height: 400px;">
                <canvas id="category-chart" class="chart-canvas" 
                        role="img" 
                        tabindex="0"
                        aria-label="Spending categories donut chart. Use arrow keys to navigate, Enter to interact."></canvas>
            </div>
            
            <p style="text-align: center; color: var(--color-text-secondary); margin-top: 1rem; font-size: 0.875rem;">
                💡 Click on categories or legend items to see detailed transaction lists
            </p>
        </div>

        <!-- Budget Progress Bars -->
        <div class="chart-container">
            <h2 class="chart-title">
                <span class="chart-title-icon">🎯</span>
                Budget Goals Progress
            </h2>
            
            <!-- Loading Skeleton -->
            <div id="progress-bars-skeleton" style="display: none;">
                <div class="skeleton skeleton-progress-bar"></div>
                <div class="skeleton skeleton-progress-bar"></div>
                <div class="skeleton skeleton-progress-bar"></div>
            </div>
            
            <!-- Progress Bars Container -->
            <div id="progress-bars-container" role="region" aria-label="Budget goals progress bars">
                <!-- Progress bars will be dynamically generated here -->
            </div>
            
            <p style="color: var(--color-text-secondary); margin-top: 1rem; font-size: 0.875rem;">
                📊 Use Tab to navigate between goals, Enter to view details, or click "View details" buttons
            </p>
        </div>

        <!-- Spending Trends Line Chart -->
        <div class="chart-container">
            <h2 class="chart-title">
                <span class="chart-title-icon">📈</span>
                Spending Trends Over Time
            </h2>
            
            <!-- Loading Skeleton -->
            <div id="trends-chart-skeleton" class="skeleton skeleton-chart" style="display: none;"
                 aria-label="Loading spending trends chart"></div>
            
            <!-- Chart Canvas -->
            <div style="position: relative; height: 400px;">
                <canvas id="trends-chart" class="chart-canvas" 
                        role="img" 
                        tabindex="0"
                        aria-label="Monthly spending trends line chart comparing actual spending vs budget target."></canvas>
            </div>
            
            <p style="text-align: center; color: var(--color-text-secondary); margin-top: 1rem; font-size: 0.875rem;">
                📅 Click on data points to see detailed monthly breakdowns
            </p>
        </div>

        <!-- Monthly Comparison Bar Chart -->
        <div class="chart-container">
            <h2 class="chart-title">
                <span class="chart-title-icon">📊</span>
                Monthly Spending Comparison
            </h2>
            
            <!-- Loading Skeleton -->
            <div id="monthly-chart-skeleton" class="skeleton skeleton-chart" style="display: none;"
                 aria-label="Loading monthly comparison chart"></div>
            
            <!-- Chart Canvas -->
            <div style="position: relative; height: 400px;">
                <canvas id="monthly-chart" class="chart-canvas" 
                        role="img" 
                        tabindex="0"
                        aria-label="Monthly spending comparison bar chart showing this year vs last year."></canvas>
            </div>
            
            <p style="text-align: center; color: var(--color-text-secondary); margin-top: 1rem; font-size: 0.875rem;">
                📈 Click on bars to see year-over-year comparison details
            </p>
        </div>

        <!-- Instructions for ADHD Users -->
        <div class="chart-container" style="border-left: 4px solid var(--color-cozy-blue);">
            <h2 class="chart-title">
                <span class="chart-title-icon">💡</span>
                How to Use These Charts
            </h2>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;">
                <div style="padding: 1rem; background-color: var(--color-background); border-radius: var(--border-radius-md);">
                    <h3 style="color: var(--color-text-primary); margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                        ⌨️ Keyboard Navigation
                    </h3>
                    <ul style="color: var(--color-text-secondary); font-size: 0.875rem; line-height: 1.5; list-style: none; padding: 0;">
                        <li>• <strong>Tab:</strong> Move between charts</li>
                        <li>• <strong>Enter/Space:</strong> Interact with focused element</li>
                        <li>• <strong>Arrow Keys:</strong> Navigate within charts</li>
                        <li>• <strong>Esc:</strong> Close modals/details</li>
                    </ul>
                </div>
                
                <div style="padding: 1rem; background-color: var(--color-background); border-radius: var(--border-radius-md);">
                    <h3 style="color: var(--color-text-primary); margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                        🖱️ Mouse Interactions
                    </h3>
                    <ul style="color: var(--color-text-secondary); font-size: 0.875rem; line-height: 1.5; list-style: none; padding: 0;">
                        <li>• <strong>Click:</strong> View category/month details</li>
                        <li>• <strong>Hover:</strong> See tooltips with extra info</li>
                        <li>• <strong>Legend Click:</strong> Toggle data visibility</li>
                        <li>• <strong>Progress Click:</strong> Edit budget goals</li>
                    </ul>
                </div>
                
                <div style="padding: 1rem; background-color: var(--color-background); border-radius: var(--border-radius-md);">
                    <h3 style="color: var(--color-text-primary); margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                        🎨 Visual Indicators
                    </h3>
                    <ul style="color: var(--color-text-secondary); font-size: 0.875rem; line-height: 1.5; list-style: none; padding: 0;">
                        <li>• <strong style="color: var(--color-success-green);">Green:</strong> On track/Good</li>
                        <li>• <strong style="color: var(--color-warning-amber);">Amber:</strong> Getting close to limit</li>
                        <li>• <strong style="color: var(--color-soft-red);">Red:</strong> Over budget/Needs attention</li>
                        <li>• <strong>Emojis:</strong> Quick visual category recognition</li>
                    </ul>
                </div>
                
                <div style="padding: 1rem; background-color: var(--color-background); border-radius: var(--border-radius-md);">
                    <h3 style="color: var(--color-text-primary); margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                        📱 Mobile Features
                    </h3>
                    <ul style="color: var(--color-text-secondary); font-size: 0.875rem; line-height: 1.5; list-style: none; padding: 0;">
                        <li>• <strong>Touch:</strong> Tap charts for details</li>
                        <li>• <strong>Swipe:</strong> Navigate between sections</li>
                        <li>• <strong>Pinch:</strong> Zoom in on chart details</li>
                        <li>• <strong>Large Text:</strong> Easy-to-read labels</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Accessibility Features -->
        <div class="chart-container" style="border-left: 4px solid var(--color-success-green);">
            <h2 class="chart-title">
                <span class="chart-title-icon">♿</span>
                Accessibility Features
            </h2>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem;">
                <div>
                    <h3 style="color: var(--color-text-primary); margin-bottom: 0.5rem;">🔊 Screen Reader Support</h3>
                    <p style="color: var(--color-text-secondary); font-size: 0.875rem; line-height: 1.5;">
                        All charts include comprehensive ARIA labels, live regions for updates, and detailed descriptions 
                        that announce data changes and interactions.
                    </p>
                </div>
                
                <div>
                    <h3 style="color: var(--color-text-primary); margin-bottom: 0.5rem;">🎨 High Contrast Mode</h3>
                    <p style="color: var(--color-text-secondary); font-size: 0.875rem; line-height: 1.5;">
                        Automatic detection and adaptation for high contrast preferences, with enhanced borders 
                        and stronger color differentiation.
                    </p>
                </div>
                
                <div>
                    <h3 style="color: var(--color-text-primary); margin-bottom: 0.5rem;">⏸️ Reduced Motion</h3>
                    <p style="color: var(--color-text-secondary); font-size: 0.875rem; line-height: 1.5;">
                        Respects motion sensitivity preferences by disabling animations and transitions 
                        when reduced motion is requested.
                    </p>
                </div>
                
                <div>
                    <h3 style="color: var(--color-text-primary); margin-bottom: 0.5rem;">🔍 Colorblind Friendly</h3>
                    <p style="color: var(--color-text-secondary); font-size: 0.875rem; line-height: 1.5;">
                        Color palette tested for deuteranopia, protanopia, and tritanopia. Uses patterns, 
                        shapes, and text labels alongside color coding.
                    </p>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer style="text-align: center; padding: 2rem 0; color: var(--color-text-secondary); border-top: 1px solid var(--color-grid-lines); margin-top: 2rem;">
            <p style="margin-bottom: 0.5rem;">Built with ❤️ for the ADHD community</p>
            <p style="font-size: 0.875rem;">
                🧠 Designed to reduce cognitive load • 
                🎨 ADHD-friendly colors • 
                ♿ Fully accessible • 
                📱 Mobile optimized
            </p>
        </footer>
    </div>

    <!-- Load BrainBudget Charts JavaScript -->
    <script src="../static/js/charts.js"></script>
    
    <!-- Demo Enhancement Script -->
    <script>
        // Add some demo-specific enhancements
        document.addEventListener('DOMContentLoaded', function() {
            // Add some visual feedback for the demo
            console.log('🧠💰 BrainBudget Charts Demo loaded!');
            console.log('Features:');
            console.log('  ✅ ADHD-friendly color palette');
            console.log('  ✅ Keyboard navigation (Tab, Enter, Arrow keys)');
            console.log('  ✅ Screen reader support');
            console.log('  ✅ Touch-friendly mobile interactions');
            console.log('  ✅ Reduced motion support');
            console.log('  ✅ High contrast mode');
            console.log('  ✅ Export functionality');
            console.log('');
            console.log('Try clicking on charts, progress bars, or using keyboard navigation!');
            
            // Add demo notification
            if (!sessionStorage.getItem('demoNotificationShown')) {
                setTimeout(() => {
                    const notification = document.createElement('div');
                    notification.style.cssText = `
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background: var(--color-cozy-blue);
                        color: white;
                        padding: 1rem;
                        border-radius: var(--border-radius-md);
                        box-shadow: var(--shadow-lg);
                        max-width: 300px;
                        z-index: 1000;
                        font-family: var(--font-family);
                        animation: slideIn 0.5s ease-out;
                    `;
                    
                    notification.innerHTML = `
                        <div style="display: flex; align-items: flex-start; gap: 0.5rem;">
                            <span style="font-size: 1.25rem;">💡</span>
                            <div>
                                <strong style="display: block; margin-bottom: 0.25rem;">Demo Ready!</strong>
                                <p style="margin: 0; font-size: 0.875rem; opacity: 0.9;">
                                    Try clicking on charts, using Tab/Enter keys, or testing the export feature!
                                </p>
                            </div>
                            <button onclick="this.parentElement.parentElement.remove()" 
                                    style="background: none; border: none; color: white; cursor: pointer; font-size: 1.25rem; margin-left: auto;">×</button>
                        </div>
                    `;
                    
                    document.body.appendChild(notification);
                    sessionStorage.setItem('demoNotificationShown', 'true');
                    
                    // Auto-remove after 8 seconds
                    setTimeout(() => {
                        if (notification.parentElement) {
                            notification.remove();
                        }
                    }, 8000);
                }, 2000);
                
                // Add slide-in animation
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes slideIn {
                        from {
                            transform: translateX(100%);
                            opacity: 0;
                        }
                        to {
                            transform: translateX(0);
                            opacity: 1;
                        }
                    }
                `;
                document.head.appendChild(style);
            }
        });
        
        // Add some demo data refresh functionality
        function refreshDemoData() {
            if (window.charts) {
                console.log('🔄 Refreshing demo data...');
                charts.showSkeletons();
                setTimeout(() => {
                    charts.hideSkeletons();
                    charts.renderAllCharts();
                    console.log('✅ Demo data refreshed!');
                }, 1000);
            }
        }
        
        // Add keyboard shortcut for refreshing (Ctrl+R equivalent)
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'r' && e.shiftKey) {
                e.preventDefault();
                refreshDemoData();
            }
        });
    </script>
</body>
</html>