{% extends "base.html" %}

{% block title %}BrainBudget - ADHD-Friendly Financial Management{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="bg-gradient-to-br from-blue-50 via-white to-purple-50 py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center">
            <div class="flex justify-center mb-6">
                <div class="w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-500 rounded-xl flex items-center justify-center shadow-lg">
                    <span class="text-4xl">🧠💰</span>
                </div>
            </div>
            <h1 class="text-4xl md:text-6xl font-bold text-gray-900 mb-6">
                Financial Management for
                <span class="bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
                    ADHD Brains
                </span>
            </h1>
            <p class="text-xl text-gray-600 max-w-3xl mx-auto mb-8">
                Transform your financial stress into financial success with our neurodivergent-friendly platform. 
                Built by and for ADHD minds, with AI-powered insights, gentle guidance, and celebration of progress.
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <button id="try-now-btn" class="bg-blue-500 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-600 transition-colors shadow-lg">
                    🚀 Try Now - No Signup!
                </button>
                <a href="/coach" class="bg-purple-500 text-white px-8 py-3 rounded-lg font-semibold hover:bg-purple-600 transition-colors shadow-lg">
                    🤖 Chat with AI
                </a>
            </div>
            
            <!-- Anonymous Upload Section (Hidden Initially) -->
            <div id="guest-upload-section" class="hidden mt-8 max-w-2xl mx-auto">
                <div class="bg-white rounded-2xl shadow-lg p-8 border border-gray-200">
                    <div class="text-center mb-6">
                        <div class="text-4xl mb-4">📁</div>
                        <h3 class="text-2xl font-bold text-gray-900 mb-2">See Your Spending Instantly</h3>
                        <p class="text-gray-600">Drop your bank statement below and get ADHD-aware insights in 30 seconds!</p>
                    </div>
                    
                    <div id="guest-dropzone" class="border-2 border-dashed border-blue-300 rounded-xl p-8 text-center hover:border-blue-400 transition-colors cursor-pointer">
                        <div class="text-3xl mb-4">📊</div>
                        <p class="text-lg font-medium text-gray-700 mb-2">Drag & drop your CSV file here</p>
                        <p class="text-sm text-gray-500 mb-4">or click to browse files</p>
                        <input type="file" id="guest-file-input" accept=".csv,.txt" class="hidden">
                        <button class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                            Choose File
                        </button>
                    </div>
                    
                    <div class="mt-4 text-xs text-gray-500 text-center">
                        🔒 Your data stays private and secure. We analyze locally and don't save anything without your permission.
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Features Grid -->
<div class="py-16 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
            <h2 class="text-3xl font-bold text-gray-900 mb-4">Everything Your ADHD Brain Needs</h2>
            <p class="text-lg text-gray-600">Comprehensive financial tools designed with neurodivergent minds in mind</p>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <!-- Upload & Analysis -->
            <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-xl border border-blue-200">
                <div class="w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center mb-4">
                    <span class="text-2xl">📁</span>
                </div>
                <h3 class="text-xl font-semibold text-gray-900 mb-2">Easy Transaction Upload</h3>
                <p class="text-gray-600 mb-4">Drag-and-drop CSV files with gentle, encouraging feedback. No judgment, just progress.</p>
                <a href="/upload" class="text-blue-600 hover:text-blue-800 font-medium">Start uploading →</a>
            </div>
            
            <!-- AI Coach -->
            <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-xl border border-purple-200">
                <div class="w-12 h-12 bg-purple-500 rounded-lg flex items-center justify-center mb-4">
                    <span class="text-2xl">🤖</span>
                </div>
                <h3 class="text-xl font-semibold text-gray-900 mb-2">AI Financial Coach</h3>
                <p class="text-gray-600 mb-4">Chat with an ADHD-aware AI that understands your unique financial challenges and strengths.</p>
                <a href="/coach" class="text-purple-600 hover:text-purple-800 font-medium">Chat with coach →</a>
            </div>
            
            <!-- Smart Insights -->
            <div class="bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-xl border border-green-200">
                <div class="w-12 h-12 bg-green-500 rounded-lg flex items-center justify-center mb-4">
                    <span class="text-2xl">🧠</span>
                </div>
                <h3 class="text-xl font-semibold text-gray-900 mb-2">ADHD Pattern Insights</h3>
                <p class="text-gray-600 mb-4">ML-powered analysis that recognizes impulse spending, hyperfocus periods, and emotional triggers.</p>
                <a href="/insights" class="text-green-600 hover:text-green-800 font-medium">View insights →</a>
            </div>
            
            <!-- Personalized Advice -->
            <div class="bg-gradient-to-br from-orange-50 to-orange-100 p-6 rounded-xl border border-orange-200">
                <div class="w-12 h-12 bg-orange-500 rounded-lg flex items-center justify-center mb-4">
                    <span class="text-2xl">💡</span>
                </div>
                <h3 class="text-xl font-semibold text-gray-900 mb-2">Tailored Financial Advice</h3>
                <p class="text-gray-600 mb-4">Personalized strategies for budgeting, debt reduction, and savings that work with ADHD brains.</p>
                <a href="/advice" class="text-orange-600 hover:text-orange-800 font-medium">Get advice →</a>
            </div>
            
            <!-- Goals & Progress -->
            <div class="bg-gradient-to-br from-pink-50 to-pink-100 p-6 rounded-xl border border-pink-200">
                <div class="w-12 h-12 bg-pink-500 rounded-lg flex items-center justify-center mb-4">
                    <span class="text-2xl">🎯</span>
                </div>
                <h3 class="text-xl font-semibold text-gray-900 mb-2">Flexible Goal Setting</h3>
                <p class="text-gray-600 mb-4">ADHD-friendly goals with built-in flexibility, progress celebration, and gentle accountability.</p>
                <a href="/goals/create" class="text-pink-600 hover:text-pink-800 font-medium">Set goals →</a>
            </div>
            
            <!-- Dashboard -->
            <div class="bg-gradient-to-br from-indigo-50 to-indigo-100 p-6 rounded-xl border border-indigo-200">
                <div class="w-12 h-12 bg-indigo-500 rounded-lg flex items-center justify-center mb-4">
                    <span class="text-2xl">📊</span>
                </div>
                <h3 class="text-xl font-semibold text-gray-900 mb-2">Clean Dashboard</h3>
                <p class="text-gray-600 mb-4">Uncluttered overview of your finances with visual progress indicators and celebration of wins.</p>
                <a href="/dashboard" class="text-indigo-600 hover:text-indigo-800 font-medium">View dashboard →</a>
            </div>
        </div>
    </div>
</div>

<!-- ADHD-Specific Benefits -->
<div class="py-16 bg-gray-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
            <h2 class="text-3xl font-bold text-gray-900 mb-4">Designed for Neurodivergent Minds</h2>
            <p class="text-lg text-gray-600">Every feature built with ADHD challenges and strengths in mind</p>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
            <div class="text-center">
                <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="text-3xl">🎯</span>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Executive Function Support</h3>
                <p class="text-gray-600 text-sm">Automation reduces decision fatigue. External reminders replace unreliable memory.</p>
            </div>
            
            <div class="text-center">
                <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="text-3xl">💙</span>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Emotional Regulation</h3>
                <p class="text-gray-600 text-sm">Shame-free environment. Gentle reframing. Celebrates all progress, however small.</p>
            </div>
            
            <div class="text-center">
                <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="text-3xl">⚡</span>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Attention Management</h3>
                <p class="text-gray-600 text-sm">Bite-sized information. Visual engagement. Multiple ways to access based on current focus.</p>
            </div>
            
            <div class="text-center">
                <div class="w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="text-3xl">🎉</span>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Motivation & Dopamine</h3>
                <p class="text-gray-600 text-sm">Quick wins. Gamification elements. Progress visualization. Achievement celebration.</p>
            </div>
        </div>
    </div>
</div>

<!-- Quick Stats -->
<div class="py-16 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
            <div>
                <div class="text-4xl font-bold text-blue-600 mb-2">5+</div>
                <div class="text-lg text-gray-900 font-semibold mb-1">Advice Categories</div>
                <div class="text-gray-600">Budgeting, debt, savings, investment, emergency fund</div>
            </div>
            <div>
                <div class="text-4xl font-bold text-purple-600 mb-2">AI</div>
                <div class="text-lg text-gray-900 font-semibold mb-1">Powered Insights</div>
                <div class="text-gray-600">Machine learning that understands ADHD patterns</div>
            </div>
            <div>
                <div class="text-4xl font-bold text-green-600 mb-2">100%</div>
                <div class="text-lg text-gray-900 font-semibold mb-1">ADHD-Friendly</div>
                <div class="text-gray-600">Every interaction designed for neurodivergent minds</div>
            </div>
        </div>
    </div>
</div>

<!-- CTA Section -->
<div class="bg-gradient-to-r from-blue-600 to-purple-600 py-16">
    <div class="max-w-4xl mx-auto text-center px-4 sm:px-6 lg:px-8">
        <h2 class="text-3xl font-bold text-white mb-4">Ready to Transform Your Financial Life?</h2>
        <p class="text-xl text-blue-100 mb-8">Join thousands of ADHD individuals who've found financial peace with BrainBudget</p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <a href="/upload" class="bg-white text-blue-600 px-8 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-colors shadow-lg">
                🚀 Start Your Journey
            </a>
            <a href="/coach" class="bg-blue-800 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-900 transition-colors shadow-lg">
                💬 Chat with AI Coach
            </a>
        </div>
    </div>
</div>

<!-- Features in Detail -->
<div class="py-16 bg-gray-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
            <h2 class="text-3xl font-bold text-gray-900 mb-4">Comprehensive Financial Toolkit</h2>
        </div>
        
        <div class="space-y-12">
            <!-- Smart Analytics -->
            <div class="flex flex-col lg:flex-row items-center gap-8">
                <div class="lg:w-1/2">
                    <h3 class="text-2xl font-bold text-gray-900 mb-4">🧠 Smart Analytics That Get You</h3>
                    <p class="text-lg text-gray-600 mb-4">
                        Our ML-powered analytics don't just track your spending—they understand your ADHD brain patterns. 
                        We recognize impulse purchases, hyperfocus spending, and emotional triggers, then provide gentle, 
                        actionable insights.
                    </p>
                    <ul class="space-y-2 text-gray-600">
                        <li class="flex items-start"><span class="text-green-500 mr-2">✓</span>Recurring transaction detection</li>
                        <li class="flex items-start"><span class="text-green-500 mr-2">✓</span>Anomaly detection for unusual spending</li>
                        <li class="flex items-start"><span class="text-green-500 mr-2">✓</span>Predictive spending forecasts</li>
                        <li class="flex items-start"><span class="text-green-500 mr-2">✓</span>ADHD pattern recognition</li>
                    </ul>
                </div>
                <div class="lg:w-1/2">
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <div class="text-4xl mb-4 text-center">📊</div>
                        <div class="space-y-3">
                            <div class="bg-blue-50 p-3 rounded-lg">
                                <div class="text-sm font-medium text-blue-800">🎉 Great Progress!</div>
                                <div class="text-xs text-blue-600">You've reduced impulse spending by 23% this month</div>
                            </div>
                            <div class="bg-purple-50 p-3 rounded-lg">
                                <div class="text-sm font-medium text-purple-800">🧠 ADHD Insight</div>
                                <div class="text-xs text-purple-600">Hyperfocus spending detected in electronics category</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Personalized Advice -->
            <div class="flex flex-col lg:flex-row-reverse items-center gap-8">
                <div class="lg:w-1/2">
                    <h3 class="text-2xl font-bold text-gray-900 mb-4">💡 Advice That Actually Works</h3>
                    <p class="text-lg text-gray-600 mb-4">
                        Forget one-size-fits-all financial advice. Our AI analyzes your unique situation, ADHD symptoms, 
                        and goals to provide personalized strategies that work with your brain, not against it.
                    </p>
                    <ul class="space-y-2 text-gray-600">
                        <li class="flex items-start"><span class="text-green-500 mr-2">✓</span>ADHD-friendly budgeting methods</li>
                        <li class="flex items-start"><span class="text-green-500 mr-2">✓</span>Automated savings strategies</li>
                        <li class="flex items-start"><span class="text-green-500 mr-2">✓</span>Debt reduction with dopamine hits</li>
                        <li class="flex items-start"><span class="text-green-500 mr-2">✓</span>Executive function support</li>
                    </ul>
                </div>
                <div class="lg:w-1/2">
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <div class="text-4xl mb-4 text-center">💡</div>
                        <div class="space-y-3">
                            <div class="bg-green-50 p-3 rounded-lg">
                                <div class="text-sm font-medium text-green-800">ADHD-Friendly Budget</div>
                                <div class="text-xs text-green-600">Use the 50/30/20 rule with visual envelopes</div>
                            </div>
                            <div class="bg-orange-50 p-3 rounded-lg">
                                <div class="text-sm font-medium text-orange-800">🎯 Action Step</div>
                                <div class="text-xs text-orange-600">Set up one automatic transfer this week</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
// Guest Upload Functionality
document.addEventListener('DOMContentLoaded', () => {
    const tryNowBtn = document.getElementById('try-now-btn');
    const guestSection = document.getElementById('guest-upload-section');
    const dropzone = document.getElementById('guest-dropzone');
    const fileInput = document.getElementById('guest-file-input');
    
    // Show/hide guest upload section
    tryNowBtn?.addEventListener('click', () => {
        guestSection?.classList.toggle('hidden');
        if (!guestSection?.classList.contains('hidden')) {
            guestSection.scrollIntoView({ behavior: 'smooth' });
        }
    });
    
    // File input handling
    dropzone?.addEventListener('click', () => {
        fileInput?.click();
    });
    
    // Drag and drop handling
    dropzone?.addEventListener('dragover', (e) => {
        e.preventDefault();
        dropzone.classList.add('border-blue-500', 'bg-blue-50');
    });
    
    dropzone?.addEventListener('dragleave', (e) => {
        e.preventDefault();
        dropzone.classList.remove('border-blue-500', 'bg-blue-50');
    });
    
    dropzone?.addEventListener('drop', (e) => {
        e.preventDefault();
        dropzone.classList.remove('border-blue-500', 'bg-blue-50');
        
        const files = e.dataTransfer.files;
        if (files.length > 0) {
            handleFileUpload(files[0]);
        }
    });
    
    fileInput?.addEventListener('change', (e) => {
        if (e.target.files.length > 0) {
            handleFileUpload(e.target.files[0]);
        }
    });
    
    async function handleFileUpload(file) {
        // Validate file type
        if (!file.name.toLowerCase().endsWith('.csv') && !file.name.toLowerCase().endsWith('.txt')) {
            showMessage('Please upload a CSV file from your bank 📊', 'error');
            return;
        }
        
        // Show loading state
        showLoading(true);
        
        try {
            const formData = new FormData();
            formData.append('file', file);
            
            const response = await fetch('/api/guest/upload', {
                method: 'POST',
                body: formData
            });
            
            if (!response.ok) {
                throw new Error(`Server error: ${response.status} ${response.statusText}`);
            }
            
            const result = await response.json();
            
            if (result.success) {
                // Celebrate successful analysis
                if (window.celebrations) {
                    window.celebrations.celebrateUpload();
                }
                showAnalysisResults(result);
                showSignupIncentive(result.signup_incentive);
            } else {
                showMessage(result.message || 'Something went wrong, but don\\'t worry! Please try again 🤗', 'error');
            }
            
        } catch (error) {
            console.error('Upload error:', error);
            showMessage(`Upload failed: ${error.message || error}. Please try again! 🔄`, 'error');
        } finally {
            showLoading(false);
        }
    }
    
    function showLoading(loading) {
        const dropzone = document.getElementById('guest-dropzone');
        if (loading) {
            dropzone.innerHTML = `
                <div class="text-center">
                    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"></div>
                    <p class="text-lg font-medium text-gray-700">🧠 Analyzing your spending patterns...</p>
                    <p class="text-sm text-gray-500">This usually takes 30 seconds</p>
                </div>
            `;
        }
    }
    
    function showAnalysisResults(result) {
        const analysis = result.analysis;
        const guestSection = document.getElementById('guest-upload-section');
        
        // Create results display
        const resultsHTML = `
            <div class="bg-white rounded-2xl shadow-lg p-8 border border-gray-200 mt-6">
                <div class="text-center mb-6">
                    <div class="text-4xl mb-4">🎉</div>
                    <h3 class="text-2xl font-bold text-gray-900 mb-2">${result.guest_experience.message}</h3>
                    <p class="text-gray-600">${result.guest_experience.encouragement}</p>
                </div>
                
                <div class="space-y-6">
                    <!-- Quick Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-blue-50 p-4 rounded-lg text-center">
                            <div class="text-2xl font-bold text-blue-600">${analysis.transaction_count || 0}</div>
                            <div class="text-sm text-blue-800">Transactions Analyzed</div>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg text-center">
                            <div class="text-2xl font-bold text-green-600">$${Math.abs(analysis.total_spending || 0).toFixed(0)}</div>
                            <div class="text-sm text-green-800">Total Spending</div>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg text-center">
                            <div class="text-2xl font-bold text-purple-600">${Object.keys(analysis.category_breakdown || {}).length}</div>
                            <div class="text-sm text-purple-800">Categories Found</div>
                        </div>
                    </div>
                    
                    <!-- Top Categories -->
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-gray-900 mb-3">💳 Where Your Money Goes</h4>
                        <div class="space-y-2">
                            ${Object.entries(analysis.category_breakdown || {}).slice(0, 5).map(([category, amount]) => `
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-700 capitalize">${category.replace('_', ' ')}</span>
                                    <span class="font-medium">$${Math.abs(amount).toFixed(2)}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    ${result.guest_limitation ? `
                        <div class="bg-blue-50 border border-blue-200 p-4 rounded-lg">
                            <p class="text-blue-800 text-sm">${result.guest_limitation.message}</p>
                            <p class="text-blue-600 text-xs mt-1">${result.guest_limitation.full_message}</p>
                        </div>
                    ` : ''}
                </div>
            </div>
        `;
        
        guestSection.insertAdjacentHTML('beforeend', resultsHTML);
    }
    
    function showSignupIncentive(incentive) {
        if (!incentive) return;
        
        const incentiveHTML = `
            <div class="bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-2xl p-8 mt-6">
                <div class="text-center">
                    <h3 class="text-2xl font-bold mb-4">${incentive.title}</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-6">
                        ${incentive.benefits.map(benefit => `
                            <div class="flex items-center">
                                <span class="text-yellow-300 mr-2">✓</span>
                                <span class="text-sm">${benefit}</span>
                            </div>
                        `).join('')}
                    </div>
                    <div class="flex flex-col sm:flex-row gap-4 justify-center">
                        <a href="/auth/signup" class="bg-white text-blue-600 px-8 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-colors">
                            🚀 Create Free Account
                        </a>
                        <button onclick="showDemo()" class="bg-blue-800 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-900 transition-colors">
                            📱 See More Features
                        </button>
                    </div>
                </div>
            </div>
        `;
        
        document.getElementById('guest-upload-section').insertAdjacentHTML('beforeend', incentiveHTML);
    }
    
    function showMessage(message, type) {
        const alertClass = type === 'error' ? 'bg-red-50 text-red-800 border-red-200' : 'bg-green-50 text-green-800 border-green-200';
        const messageHTML = `
            <div class="${alertClass} border p-4 rounded-lg mb-4">
                ${message}
            </div>
        `;
        
        const guestSection = document.getElementById('guest-upload-section');
        guestSection.insertAdjacentHTML('beforeend', messageHTML);
    }
    
    // Global function for demo
    window.showDemo = () => {
        window.location.href = '/dashboard';
    };
});
</script>

<style>
/* Custom animations for hero section */
@keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-10px); }
}

.floating {
    animation: float 3s ease-in-out infinite;
}

/* Gentle hover effects */
.gentle-hover {
    transition: all 0.3s ease;
}

.gentle-hover:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
}

/* ADHD-friendly focus styles */
*:focus {
    outline: 2px solid #4A90E2;
    outline-offset: 2px;
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
    .floating {
        animation: none;
    }
    
    .gentle-hover {
        transition: none;
    }
}
</style>
{% endblock %}