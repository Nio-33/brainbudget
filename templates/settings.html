{% extends "base.html" %}

{% block title %}Settings - BrainBudget{% endblock %}

{% block content %}
<!-- Settings Page -->
<div class="min-h-screen" style="background-color: #EFDFC5;">
    <!-- Navigation Header -->
    <header class="absolute top-4 left-4 right-4 z-10 animate-fadeIn">
        <div class="flex justify-between items-center">
            <div class="flex space-x-8">
                <a href="/home" class="flex items-center space-x-2 hover:opacity-80 transition-colors" style="color: #252B2B;">
                    <span>üè†</span>
                    <span>Home</span>
                </a>
            </div>
            <div class="flex items-center space-x-4">
                <!-- Community link removed - clean navigation -->
            </div>
        </div>
    </header>

    <!-- Header Section -->
    <div class="relative py-16 px-4">
        <div class="max-w-6xl mx-auto text-center">
            <div class="mb-6">
                <span class="text-6xl">‚öôÔ∏è</span>
            </div>
            <h1 class="text-4xl md:text-5xl font-bold mb-4" style="color: #380F17;">
                Settings & Preferences
            </h1>
            <p class="text-lg max-w-2xl mx-auto leading-relaxed" style="color: #252B2B;">
                Make BrainBudget work perfectly for you. Customize everything to your needs and preferences.
            </p>
        </div>
    </div>

    <!-- Settings Content -->
    <div class="py-12 px-4">
        <div class="max-w-4xl mx-auto">
            <!-- Settings Tabs -->
            <div class="mb-8">
                <div class="flex flex-wrap justify-center space-x-2 mb-8">
                    <button class="settings-tab active px-6 py-3 font-semibold rounded-full transition-all duration-200" data-tab="preferences" style="background-color: #380F17; color: #EFDFC5;">
                        üß† User Preferences
                    </button>
                    <button class="settings-tab px-6 py-3 font-semibold rounded-full transition-all duration-200" data-tab="display" style="background-color: rgba(255, 255, 255, 0.8); color: #252B2B;">
                        üé® Display
                    </button>
                    <button class="settings-tab px-6 py-3 font-semibold rounded-full transition-all duration-200" data-tab="notifications" style="background-color: rgba(255, 255, 255, 0.8); color: #252B2B;">
                        üîî Notifications
                    </button>
                    <button class="settings-tab px-6 py-3 font-semibold rounded-full transition-all duration-200" data-tab="privacy" style="background-color: rgba(255, 255, 255, 0.8); color: #252B2B;">
                        üîí Privacy
                    </button>
                </div>
            </div>
            
            <!-- ADHD Preferences Tab -->
            <div id="preferences-tab" class="settings-content active">
                <div class="space-y-8">
                    <!-- ADHD-Specific Features -->
                    <div class="backdrop-blur-sm rounded-3xl p-8" style="background-color: rgba(255, 255, 255, 0.9); border: 1px solid #380F17;">
                        <div class="mb-6">
                            <h2 class="text-2xl font-bold mb-2 flex items-center" style="color: #380F17;">
                                <span class="mr-3 text-3xl">üß†</span>
                                User-Friendly Features
                            </h2>
                            <p style="color: #4C4F54;">Customize how information is presented to work best for you</p>
                        </div>
                        
                        <div class="space-y-6">
                            <!-- Reduce Animations -->
                            <div class="flex items-center justify-between p-4 rounded-2xl" style="background-color: rgba(239, 223, 197, 0.8);">
                                <div>
                                    <h3 class="font-semibold" style="color: #380F17;">Reduce Animations</h3>
                                    <p class="text-sm" style="color: #4C4F54;">Minimize moving elements for better focus</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" class="sr-only peer" id="reduce-motion">
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all" style="peer-checked:background-color: #380F17;"></div>
                                </label>
                            </div>
                            
                            <!-- Currency Selection -->
                            <div class="p-4 rounded-2xl" style="background-color: rgba(239, 223, 197, 0.8);">
                                <h3 class="font-semibold mb-3" style="color: #380F17;">Preferred Currency</h3>
                                <select id="currency-select" class="w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-primary-500 focus:border-transparent" style="background-color: rgba(255, 255, 255, 0.9);">
                                    {% for code, info in supported_currencies.items() %}
                                    <option value="{{ code }}" {% if code == current_currency %}selected{% endif %}>
                                        {% if code == 'USD' %}üá∫üá∏{% elif code == 'NGN' %}üá≥üá¨{% elif code == 'EUR' %}üá™üá∫{% elif code == 'GBP' %}üá¨üáß{% endif %} 
                                        {{ info.name }} ({{ info.symbol }})
                                    </option>
                                    {% endfor %}
                                </select>
                                <p class="text-sm mt-2" style="color: #4C4F54;">Choose your preferred currency for displaying amounts throughout the app</p>
                            </div>
                            
                            <!-- Information Density -->
                            <div class="p-4 rounded-2xl" style="background-color: rgba(239, 223, 197, 0.8);">
                                <h3 class="font-semibold mb-3" style="color: #380F17;">Information Density</h3>
                                <div class="space-y-3">
                                    <label class="flex items-center">
                                        <input type="radio" name="density" value="comfortable" checked style="color: #380F17;">
                                        <span class="ml-3">
                                            <span class="font-semibold" style="color: #380F17;">Comfortable</span>
                                            <span class="block text-sm" style="color: #4C4F54;">Extra spacing, larger elements (Recommended)</span>
                                        </span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="density" value="compact" style="color: #380F17;">
                                        <span class="ml-3">
                                            <span class="font-semibold" style="color: #380F17;">Compact</span>
                                            <span class="block text-sm" style="color: #4C4F54;">More information on screen</span>
                                        </span>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Color Coding -->
                            <div class="flex items-center justify-between p-4 rounded-2xl" style="background-color: rgba(239, 223, 197, 0.8);">
                                <div>
                                    <h3 class="font-semibold" style="color: #380F17;">Enhanced Color Coding</h3>
                                    <p class="text-sm" style="color: #4C4F54;">Use colors to categorize spending patterns</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" class="sr-only peer" id="color-coding" checked>
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all" style="peer-checked:background-color: #380F17;"></div>
                                </label>
                            </div>
                            
                            <!-- Focus Mode -->
                            <div class="flex items-center justify-between p-4 rounded-2xl" style="background-color: rgba(239, 223, 197, 0.8);">
                                <div>
                                    <h3 class="font-semibold" style="color: #380F17;">Focus Mode</h3>
                                    <p class="text-sm" style="color: #4C4F54;">Hide distracting elements during analysis</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" class="sr-only peer" id="focus-mode">
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all" style="peer-checked:background-color: #380F17;"></div>
                                </label>
                            </div>
                            
                            <!-- Executive Function Support -->
                            <div class="flex items-center justify-between p-4 rounded-2xl" style="background-color: rgba(239, 223, 197, 0.8);">
                                <div>
                                    <h3 class="font-semibold" style="color: #380F17;">Executive Function Aids</h3>
                                    <p class="text-sm" style="color: #4C4F54;">Extra reminders and step-by-step guidance</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" class="sr-only peer" id="executive-support" checked>
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all" style="peer-checked:background-color: #380F17;"></div>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Display Preferences Tab -->
            <div id="display-tab" class="settings-content hidden">
                <div class="space-y-8">
                    <div class="backdrop-blur-sm rounded-3xl p-8" style="background-color: rgba(255, 255, 255, 0.9); border: 1px solid #380F17;">
                        <div class="mb-6">
                            <h2 class="text-2xl font-bold mb-2 flex items-center" style="color: #380F17;">
                                <span class="mr-3 text-3xl">üé®</span>
                                Display Preferences
                            </h2>
                            <p style="color: #4C4F54;">Adjust the visual appearance to your liking</p>
                        </div>
                        
                        <div class="grid md:grid-cols-2 gap-8">
                            <!-- Theme Selection -->
                            <div>
                                <h3 class="font-semibold mb-4" style="color: #380F17;">Color Theme</h3>
                                <div class="space-y-3">
                                    <label class="flex items-center p-4 rounded-xl cursor-pointer hover:shadow-md transition-all" style="background-color: rgba(239, 223, 197, 0.8);">
                                        <input type="radio" name="theme" value="light" checked style="color: #380F17;">
                                        <span class="ml-3">
                                            <span class="font-semibold" style="color: #380F17;">Light & Warm</span>
                                            <span class="block text-sm" style="color: #4C4F54;">Cream background (Current BrainBudget theme)</span>
                                        </span>
                                    </label>
                                    <label class="flex items-center p-4 rounded-xl cursor-pointer hover:shadow-md transition-all" style="background-color: rgba(239, 223, 197, 0.8);">
                                        <input type="radio" name="theme" value="dark" style="color: #380F17;">
                                        <span class="ml-3">
                                            <span class="font-semibold" style="color: #380F17;">Dark Mode</span>
                                            <span class="block text-sm" style="color: #4C4F54;">Easier on the eyes for evening use</span>
                                        </span>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Font Size -->
                            <div>
                                <h3 class="font-semibold mb-4" style="color: #380F17;">Text Size</h3>
                                <div class="p-4 rounded-xl" style="background-color: rgba(239, 223, 197, 0.8);">
                                    <select id="font-size" class="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:outline-none" style="focus:ring-color: #380F17;">
                                        <option value="small">Small</option>
                                        <option value="medium" selected>Medium (Recommended)</option>
                                        <option value="large">Large</option>
                                        <option value="extra-large">Extra Large</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Notifications Tab -->
            <div id="notifications-tab" class="settings-content hidden">
                <div class="space-y-8">
                    <div class="backdrop-blur-sm rounded-3xl p-8" style="background-color: rgba(255, 255, 255, 0.9); border: 1px solid #380F17;">
                        <div class="mb-6">
                            <h2 class="text-2xl font-bold mb-2 flex items-center" style="color: #380F17;">
                                <span class="mr-3 text-3xl">üîî</span>
                                Gentle Financial Reminders
                            </h2>
                            <p style="color: #4C4F54;">Get kind, helpful notifications that work for you</p>
                        </div>
                        
                        <div class="space-y-6">
                            <!-- Master Toggle -->
                            <div class="flex items-center justify-between p-4 rounded-xl" style="background-color: rgba(56, 15, 23, 0.1); border: 2px solid #380F17;">
                                <div>
                                    <h3 class="font-semibold" style="color: #380F17;">All Notifications</h3>
                                    <p class="text-sm" style="color: #4C4F54;">Master switch for all BrainBudget notifications</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" class="sr-only peer" id="notifications-master" checked>
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all" style="peer-checked:background-color: #380F17;"></div>
                                </label>
                            </div>
                            
                            <!-- Spending Alerts -->
                            <div class="p-4 rounded-xl" style="background-color: rgba(239, 223, 197, 0.8);">
                                <div class="flex items-center justify-between mb-3">
                                    <div>
                                        <h4 class="font-semibold flex items-center" style="color: #380F17;">
                                            <span class="mr-2">üí∞</span>
                                            Spending Reminders
                                        </h4>
                                        <p class="text-sm" style="color: #4C4F54;">Gentle nudges when approaching budget limits</p>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" class="sr-only peer" id="spending-alerts" checked>
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all" style="peer-checked:background-color: #380F17;"></div>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Goal Celebrations -->
                            <div class="p-4 rounded-xl" style="background-color: rgba(239, 223, 197, 0.8);">
                                <div class="flex items-center justify-between mb-3">
                                    <div>
                                        <h4 class="font-semibold flex items-center" style="color: #380F17;">
                                            <span class="mr-2">üéâ</span>
                                            Goal Celebrations
                                        </h4>
                                        <p class="text-sm" style="color: #4C4F54;">Celebrate your wins! You deserve recognition</p>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" class="sr-only peer" id="goal-celebrations" checked>
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all" style="peer-checked:background-color: #380F17;"></div>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Daily Encouragement -->
                            <div class="p-4 rounded-xl" style="background-color: rgba(239, 223, 197, 0.8);">
                                <div class="flex items-center justify-between mb-3">
                                    <div>
                                        <h4 class="font-semibold flex items-center" style="color: #380F17;">
                                            <span class="mr-2">üíú</span>
                                            Daily Encouragement
                                        </h4>
                                        <p class="text-sm" style="color: #4C4F54;">Supportive messages to help you stay motivated</p>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" class="sr-only peer" id="daily-encouragement" checked>
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all" style="peer-checked:background-color: #380F17;"></div>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Quiet Hours -->
                            <div class="p-4 rounded-xl" style="background-color: rgba(56, 15, 23, 0.1); border: 1px solid #380F17;">
                                <h4 class="font-semibold mb-3 flex items-center" style="color: #380F17;">
                                    <span class="mr-2">üò¥</span>
                                    Quiet Hours
                                </h4>
                                <p class="text-sm mb-4" style="color: #4C4F54;">No notifications during your rest time</p>
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-semibold mb-2" style="color: #380F17;">Start:</label>
                                        <input type="time" id="quiet-start" value="22:00" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:outline-none" style="focus:ring-color: #380F17;">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-semibold mb-2" style="color: #380F17;">End:</label>
                                        <input type="time" id="quiet-end" value="08:00" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:outline-none" style="focus:ring-color: #380F17;">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Privacy Tab -->
            <div id="privacy-tab" class="settings-content hidden">
                <div class="space-y-8">
                    <div class="backdrop-blur-sm rounded-3xl p-8" style="background-color: rgba(255, 255, 255, 0.9); border: 1px solid #380F17;">
                        <div class="mb-6">
                            <h2 class="text-2xl font-bold mb-2 flex items-center" style="color: #380F17;">
                                <span class="mr-3 text-3xl">üîí</span>
                                Privacy & Data Control
                            </h2>
                            <p style="color: #4C4F54;">You have complete control over your financial data</p>
                        </div>
                        
                        <div class="space-y-6">
                            <!-- Data Control -->
                            <div class="p-4 rounded-xl" style="background-color: rgba(239, 223, 197, 0.8);">
                                <h3 class="font-semibold mb-3" style="color: #380F17;">Data Sharing</h3>
                                <div class="space-y-3">
                                    <label class="flex items-center">
                                        <input type="checkbox" style="color: #380F17;">
                                        <span class="ml-3">
                                            <span class="font-semibold" style="color: #380F17;">Anonymous Usage Analytics</span>
                                            <span class="block text-sm" style="color: #4C4F54;">Help us improve BrainBudget with anonymous usage data</span>
                                        </span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" style="color: #380F17;">
                                        <span class="ml-3">
                                            <span class="font-semibold" style="color: #380F17;">Community Features</span>
                                            <span class="block text-sm" style="color: #4C4F54;">Enable participation in community discussions</span>
                                        </span>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Account Actions -->
                            <div class="p-4 rounded-xl" style="background-color: rgba(255, 192, 203, 0.3); border: 1px solid #8F0B13;">
                                <h3 class="font-semibold mb-3 flex items-center" style="color: #8F0B13;">
                                    <span class="mr-2">‚ö†Ô∏è</span>
                                    Account Actions
                                </h3>
                                <p class="text-sm mb-4" style="color: #4C4F54;">These actions affect your entire account</p>
                                <div class="space-y-3">
                                    <button class="w-full px-4 py-3 bg-white border-2 rounded-xl font-semibold hover:shadow-md transition-all" style="border-color: #8F0B13; color: #8F0B13;">
                                        üì§ Export All My Data
                                    </button>
                                    <button class="w-full px-4 py-3 rounded-xl text-white font-semibold hover:shadow-md transition-all" style="background-color: #8F0B13;">
                                        üîÑ Reset All Settings
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Save Button -->
            <div class="mt-12 text-center">
                <button id="save-all-settings" class="inline-flex items-center justify-center px-12 py-4 font-bold text-xl text-white brain-gradient rounded-full shadow-lg hover:shadow-xl transition-all duration-200">
                    <span class="mr-3">üíæ</span>
                    Save All Settings
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="py-8 text-center animate-fadeIn">
        <div class="max-w-4xl mx-auto px-4">
            <p class="text-sm" style="color: #4C4F54;">
                BrainBudget - Making budgeting accessible | powered by <span class="font-semibold" style="color: #8F0B13;">Niostudio</span>
            </p>
        </div>
    </footer>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Tab switching functionality
    document.querySelectorAll('.settings-tab').forEach(tab => {
        tab.addEventListener('click', function() {
            const targetTab = this.dataset.tab;
            
            // Remove active class from all tabs
            document.querySelectorAll('.settings-tab').forEach(t => {
                t.classList.remove('active');
                t.style.backgroundColor = 'rgba(255, 255, 255, 0.8)';
                t.style.color = '#252B2B';
            });
            
            // Add active class to clicked tab
            this.classList.add('active');
            this.style.backgroundColor = '#380F17';
            this.style.color = '#EFDFC5';
            
            // Hide all content
            document.querySelectorAll('.settings-content').forEach(content => {
                content.classList.remove('active');
                content.classList.add('hidden');
            });
            
            // Show target content
            const targetContent = document.getElementById(`${targetTab}-tab`);
            targetContent.classList.add('active');
            targetContent.classList.remove('hidden');
        });
    });
    
    // Save all settings
    document.getElementById('save-all-settings').addEventListener('click', function() {
        // Collect all settings
        const settings = {
            // ADHD Preferences
            reduceMotion: document.getElementById('reduce-motion').checked,
            density: document.querySelector('input[name="density"]:checked')?.value || 'comfortable',
            colorCoding: document.getElementById('color-coding').checked,
            focusMode: document.getElementById('focus-mode').checked,
            executiveSupport: document.getElementById('executive-support').checked,
            
            // Display
            theme: document.querySelector('input[name="theme"]:checked')?.value || 'light',
            fontSize: document.getElementById('font-size').value,
            currency: document.getElementById('currency-select').value,
            
            // Notifications
            notificationsMaster: document.getElementById('notifications-master').checked,
            spendingAlerts: document.getElementById('spending-alerts').checked,
            goalCelebrations: document.getElementById('goal-celebrations').checked,
            dailyEncouragement: document.getElementById('daily-encouragement').checked,
            quietStart: document.getElementById('quiet-start').value,
            quietEnd: document.getElementById('quiet-end').value
        };
        
        // Save currency preference to server
        if (settings.currency) {
            fetch('/api/settings/currency', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ currency: settings.currency })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    console.log('Currency preference saved');
                }
            })
            .catch(error => {
                console.error('Error saving currency preference:', error);
            });
        }
        
        // Save to localStorage (in production, this would be an API call)
        localStorage.setItem('brainbudget-settings', JSON.stringify(settings));
        
        // Show success message
        showSuccessToast('‚ú® Settings saved successfully! Your preferences are now active.');
        
        // Apply settings immediately
        applySettings(settings);
    });
    
    // Load saved settings
    const savedSettings = localStorage.getItem('brainbudget-settings');
    if (savedSettings) {
        const settings = JSON.parse(savedSettings);
        applySettings(settings);
        populateSettings(settings);
    }
    
    function applySettings(settings) {
        // Apply reduce motion
        if (settings.reduceMotion) {
            document.documentElement.style.setProperty('--animation-duration', '0.01ms');
        }
        
        // Apply theme
        if (settings.theme === 'dark') {
            document.documentElement.classList.add('dark-mode');
        }
        
        // Apply font size
        const fontSizes = {
            'small': '14px',
            'medium': '16px', 
            'large': '18px',
            'extra-large': '20px'
        };
        if (settings.fontSize) {
            document.documentElement.style.fontSize = fontSizes[settings.fontSize] || '16px';
        }
    }
    
    function populateSettings(settings) {
        // Populate form fields with saved values
        if (settings.reduceMotion) document.getElementById('reduce-motion').checked = true;
        if (settings.colorCoding !== undefined) document.getElementById('color-coding').checked = settings.colorCoding;
        if (settings.focusMode) document.getElementById('focus-mode').checked = true;
        if (settings.executiveSupport !== undefined) document.getElementById('executive-support').checked = settings.executiveSupport;
        if (settings.notificationsMaster !== undefined) document.getElementById('notifications-master').checked = settings.notificationsMaster;
        if (settings.spendingAlerts !== undefined) document.getElementById('spending-alerts').checked = settings.spendingAlerts;
        if (settings.goalCelebrations !== undefined) document.getElementById('goal-celebrations').checked = settings.goalCelebrations;
        if (settings.dailyEncouragement !== undefined) document.getElementById('daily-encouragement').checked = settings.dailyEncouragement;
        if (settings.fontSize) document.getElementById('font-size').value = settings.fontSize;
        if (settings.currency) document.getElementById('currency').value = settings.currency;
        if (settings.quietStart) document.getElementById('quiet-start').value = settings.quietStart;
        if (settings.quietEnd) document.getElementById('quiet-end').value = settings.quietEnd;
        
        // Update radio button selections
        if (settings.density) {
            const densityRadio = document.querySelector(`input[name="density"][value="${settings.density}"]`);
            if (densityRadio) densityRadio.checked = true;
        }
        
        if (settings.theme) {
            const themeRadio = document.querySelector(`input[name="theme"][value="${settings.theme}"]`);
            if (themeRadio) themeRadio.checked = true;
        }
    }
    
    // Test notifications
    function showTestNotification(message) {
        showSuccessToast(message);
    }
});
</script>
{% endblock %}