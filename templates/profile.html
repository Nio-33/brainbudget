{% extends "base.html" %}

{% block title %}Profile - BrainBudget{% endblock %}

{% block content %}
<!-- Profile Page -->
<div class="min-h-screen" style="background-color: #EFDFC5;">
    <!-- Navigation Header -->
    <header class="absolute top-4 left-4 right-4 z-10 animate-fadeIn">
        <div class="flex justify-between items-center">
            <div class="flex space-x-8">
                <a href="/home" class="flex items-center space-x-2 hover:opacity-80 transition-colors" style="color: #252B2B;">
                    <span>üè†</span>
                    <span>Home</span>
                </a>
            </div>
            <div class="flex items-center space-x-4">
                <!-- Navigation links removed - only on homepage -->
            </div>
        </div>
    </header>

    <!-- Header Section -->
    <div class="relative py-16 px-4">
        <div class="max-w-6xl mx-auto text-center">
            <div class="mb-6">
                <span class="text-6xl">üë§</span>
            </div>
            <div class="inline-block px-8 py-4 rounded-full brain-gradient mb-6">
                <h1 class="text-4xl md:text-5xl font-bold text-white">
                    Profile
                </h1>
            </div>
            <p class="text-lg max-w-2xl mx-auto leading-relaxed" style="color: #252B2B;">
                Your personalized BrainBudget profile with ADHD-specific preferences, achievements, and financial journey insights.
            </p>
        </div>
    </div>

    <!-- Profile Content -->
    <div class="py-12 px-4">
        <div class="max-w-6xl mx-auto">
            <!-- Profile Header Card -->
            <div class="backdrop-blur-sm rounded-3xl p-8 mb-8 card-hover" style="background: linear-gradient(135deg, #380F17 0%, #8F0B13 100%); color: #EFDFC5;">
                <div class="flex flex-col md:flex-row items-center space-y-6 md:space-y-0 md:space-x-8">
                    <!-- Profile Avatar -->
                    <div class="w-32 h-32 rounded-full flex items-center justify-center text-6xl" style="background-color: #EFDFC5; color: #380F17;">
                        üß†
                    </div>
                    
                    <!-- Profile Info -->
                    <div class="flex-1 text-center md:text-left">
                        <h2 class="text-3xl font-bold mb-2">Alex Thompson</h2>
                        <p class="text-lg opacity-90 mb-4">ADHD Financial Warrior</p>
                        <div class="flex flex-wrap gap-3 justify-center md:justify-start">
                            <span class="px-4 py-2 rounded-full text-sm font-semibold" style="background-color: #EFDFC5; color: #380F17;">
                                üéØ Goal Achiever
                            </span>
                            <span class="px-4 py-2 rounded-full text-sm font-semibold" style="background-color: rgba(239, 223, 197, 0.2); color: #EFDFC5;">
                                üìä Budget Master
                            </span>
                            <span class="px-4 py-2 rounded-full text-sm font-semibold" style="background-color: rgba(239, 223, 197, 0.2); color: #EFDFC5;">
                                üß† ADHD Aware
                            </span>
                        </div>
                    </div>
                    
                    <!-- Stats Summary -->
                    <div class="text-center">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <div class="text-2xl font-bold">127</div>
                                <div class="text-sm opacity-80">Days Active</div>
                            </div>
                            <div>
                                <div class="text-2xl font-bold">3</div>
                                <div class="text-sm opacity-80">Goals Achieved</div>
                            </div>
                            <div>
                                <div class="text-2xl font-bold">85%</div>
                                <div class="text-sm opacity-80">ADHD Score</div>
                            </div>
                            <div>
                                <div class="text-2xl font-bold">$2.4K</div>
                                <div class="text-sm opacity-80">Saved Total</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Profile Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Left Column - Profile Details -->
                <div class="lg:col-span-2 space-y-8">
                    <!-- Personal Information -->
                    <div class="backdrop-blur-sm rounded-3xl p-6" style="background-color: rgba(255, 255, 255, 0.9); border: 1px solid #380F17;">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-2xl font-bold flex items-center" style="color: #380F17;">
                                <span class="mr-3 text-3xl">üìù</span>
                                Personal Information
                            </h2>
                            <button onclick="editProfile()" class="px-4 py-2 rounded-lg font-semibold transition-colors" style="background-color: #380F17; color: #EFDFC5;">
                                ‚úèÔ∏è Edit Profile
                            </button>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Basic Info -->
                            <div class="space-y-4">
                                <div class="p-4 rounded-2xl" style="background-color: rgba(239, 223, 197, 0.8);">
                                    <label class="text-sm font-semibold" style="color: #380F17;">Full Name</label>
                                    <p class="mt-1" style="color: #252B2B;">Alex Thompson</p>
                                </div>
                                
                                <div class="p-4 rounded-2xl" style="background-color: rgba(239, 223, 197, 0.8);">
                                    <label class="text-sm font-semibold" style="color: #380F17;">Email</label>
                                    <p class="mt-1" style="color: #252B2B;">alex.thompson@email.com</p>
                                </div>
                                
                                <div class="p-4 rounded-2xl" style="background-color: rgba(239, 223, 197, 0.8);">
                                    <label class="text-sm font-semibold" style="color: #380F17;">Join Date</label>
                                    <p class="mt-1" style="color: #252B2B;">August 15, 2024</p>
                                </div>
                            </div>
                            
                            <!-- ADHD Profile -->
                            <div class="space-y-4">
                                <div class="p-4 rounded-2xl" style="background-color: rgba(239, 223, 197, 0.8);">
                                    <label class="text-sm font-semibold" style="color: #380F17;">ADHD Type</label>
                                    <p class="mt-1" style="color: #252B2B;">Combined Type</p>
                                </div>
                                
                                <div class="p-4 rounded-2xl" style="background-color: rgba(239, 223, 197, 0.8);">
                                    <label class="text-sm font-semibold" style="color: #380F17;">Primary Challenges</label>
                                    <p class="mt-1 text-sm" style="color: #252B2B;">Impulse control, Executive function, Time management</p>
                                </div>
                                
                                <div class="p-4 rounded-2xl" style="background-color: rgba(239, 223, 197, 0.8);">
                                    <label class="text-sm font-semibold" style="color: #380F17;">Preferred Learning Style</label>
                                    <p class="mt-1" style="color: #252B2B;">Visual + Kinesthetic</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Financial Journey Timeline -->
                    <div class="backdrop-blur-sm rounded-3xl p-6" style="background-color: rgba(255, 255, 255, 0.9); border: 1px solid #380F17;">
                        <h2 class="text-2xl font-bold mb-6 flex items-center" style="color: #380F17;">
                            <span class="mr-3 text-3xl">üìà</span>
                            Your Financial Journey
                        </h2>
                        
                        <div class="space-y-6">
                            <!-- Timeline Item 1 -->
                            <div class="flex items-start space-x-4">
                                <div class="w-12 h-12 rounded-full flex items-center justify-center" style="background-color: #7CEC86;">
                                    <span class="text-white text-lg">‚úÖ</span>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-semibold" style="color: #380F17;">Created Emergency Fund</h3>
                                    <p class="text-sm" style="color: #4C4F54;">Saved $1,000 in 4 months ‚Ä¢ September 2024</p>
                                    <div class="mt-2 px-3 py-1 rounded-full inline-block text-xs font-semibold" style="background-color: rgba(124, 236, 134, 0.2); color: #380F17;">
                                        üéâ First Major Goal Achieved
                                    </div>
                                </div>
                            </div>

                            <!-- Timeline Item 2 -->
                            <div class="flex items-start space-x-4">
                                <div class="w-12 h-12 rounded-full flex items-center justify-center" style="background-color: #7CEC86;">
                                    <span class="text-white text-lg">‚úÖ</span>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-semibold" style="color: #380F17;">Paid Off Credit Card</h3>
                                    <p class="text-sm" style="color: #4C4F54;">Eliminated $2,500 debt ‚Ä¢ October 2024</p>
                                    <div class="mt-2 px-3 py-1 rounded-full inline-block text-xs font-semibold" style="background-color: rgba(124, 236, 134, 0.2); color: #380F17;">
                                        üí™ Debt Freedom Milestone
                                    </div>
                                </div>
                            </div>

                            <!-- Timeline Item 3 -->
                            <div class="flex items-start space-x-4">
                                <div class="w-12 h-12 rounded-full flex items-center justify-center" style="background-color: #FFC107;">
                                    <span class="text-white text-lg">üîÑ</span>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-semibold" style="color: #380F17;">Building Vacation Fund</h3>
                                    <p class="text-sm" style="color: #4C4F54;">$405 of $1,500 target ‚Ä¢ In Progress</p>
                                    <div class="mt-2 px-3 py-1 rounded-full inline-block text-xs font-semibold" style="background-color: rgba(255, 193, 7, 0.2); color: #380F17;">
                                        üéØ Current Goal - 27% Complete
                                    </div>
                                </div>
                            </div>

                            <!-- Timeline Item 4 -->
                            <div class="flex items-start space-x-4">
                                <div class="w-12 h-12 rounded-full flex items-center justify-center" style="background-color: #4C4F54;">
                                    <span class="text-white text-lg">üìÖ</span>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-semibold" style="color: #380F17;">Investment Journey Planned</h3>
                                    <p class="text-sm" style="color: #4C4F54;">Starting January 2025 ‚Ä¢ Upcoming</p>
                                    <div class="mt-2 px-3 py-1 rounded-full inline-block text-xs font-semibold" style="background-color: rgba(76, 79, 84, 0.2); color: #380F17;">
                                        üöÄ Future Goal
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Achievement Gallery -->
                    <div class="backdrop-blur-sm rounded-3xl p-6" style="background-color: rgba(255, 255, 255, 0.9); border: 1px solid #380F17;">
                        <h2 class="text-2xl font-bold mb-6 flex items-center" style="color: #380F17;">
                            <span class="mr-3 text-3xl">üèÜ</span>
                            Achievements & Badges
                        </h2>
                        
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <!-- Achievement 1 -->
                            <div class="text-center p-4 rounded-2xl" style="background-color: rgba(124, 236, 134, 0.2);">
                                <div class="text-4xl mb-2">üéØ</div>
                                <h3 class="text-sm font-semibold" style="color: #380F17;">Goal Getter</h3>
                                <p class="text-xs" style="color: #4C4F54;">First goal achieved</p>
                            </div>

                            <!-- Achievement 2 -->
                            <div class="text-center p-4 rounded-2xl" style="background-color: rgba(255, 193, 7, 0.2);">
                                <div class="text-4xl mb-2">üî•</div>
                                <h3 class="text-sm font-semibold" style="color: #380F17;">Streak Master</h3>
                                <p class="text-xs" style="color: #4C4F54;">30-day budget track</p>
                            </div>

                            <!-- Achievement 3 -->
                            <div class="text-center p-4 rounded-2xl" style="background-color: rgba(139, 92, 246, 0.2);">
                                <div class="text-4xl mb-2">üß†</div>
                                <h3 class="text-sm font-semibold" style="color: #380F17;">ADHD Warrior</h3>
                                <p class="text-xs" style="color: #4C4F54;">Impulse control pro</p>
                            </div>

                            <!-- Achievement 4 -->
                            <div class="text-center p-4 rounded-2xl" style="background-color: rgba(76, 79, 84, 0.2);">
                                <div class="text-4xl mb-2">ü§ù</div>
                                <h3 class="text-sm font-semibold" style="color: #380F17;">Community Helper</h3>
                                <p class="text-xs" style="color: #4C4F54;">10 helpful posts</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Sidebar -->
                <div class="space-y-6">
                    <!-- Quick Stats -->
                    <div class="backdrop-blur-sm rounded-3xl p-6" style="background-color: rgba(255, 255, 255, 0.9); border: 1px solid #380F17;">
                        <h3 class="text-xl font-bold mb-4 flex items-center" style="color: #380F17;">
                            <span class="mr-3 text-2xl">üìä</span>
                            Quick Stats
                        </h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-3 rounded-lg" style="background-color: rgba(239, 223, 197, 0.6);">
                                <div>
                                    <p class="text-sm font-semibold" style="color: #380F17;">Total Saved</p>
                                    <p class="text-xs" style="color: #4C4F54;">Across all goals</p>
                                </div>
                                <span class="text-lg font-bold" style="color: #8F0B13;">$2,405</span>
                            </div>
                            
                            <div class="flex items-center justify-between p-3 rounded-lg" style="background-color: rgba(239, 223, 197, 0.6);">
                                <div>
                                    <p class="text-sm font-semibold" style="color: #380F17;">Avg Monthly Save</p>
                                    <p class="text-xs" style="color: #4C4F54;">Last 3 months</p>
                                </div>
                                <span class="text-lg font-bold" style="color: #8F0B13;">$320</span>
                            </div>
                            
                            <div class="flex items-center justify-between p-3 rounded-lg" style="background-color: rgba(239, 223, 197, 0.6);">
                                <div>
                                    <p class="text-sm font-semibold" style="color: #380F17;">ADHD Score</p>
                                    <p class="text-xs" style="color: #4C4F54;">Brain-friendly habits</p>
                                </div>
                                <span class="text-lg font-bold" style="color: #7CEC86;">85%</span>
                            </div>
                        </div>
                    </div>

                    <!-- Account Actions -->
                    <div class="backdrop-blur-sm rounded-3xl p-6" style="background-color: rgba(255, 255, 255, 0.9); border: 1px solid #380F17;">
                        <h3 class="text-xl font-bold mb-4 flex items-center" style="color: #380F17;">
                            <span class="mr-3 text-2xl">‚öôÔ∏è</span>
                            Account Actions
                        </h3>
                        <div class="space-y-3">
                            <button onclick="updatePassword()" class="w-full p-3 rounded-xl font-semibold transition-colors hover:shadow-md text-left" style="background-color: #380F17; color: #EFDFC5;">
                                üîê Change Password
                            </button>
                            <button onclick="exportData()" class="w-full p-3 rounded-xl font-semibold transition-colors hover:shadow-md text-left" style="background-color: #8F0B13; color: #EFDFC5;">
                                üì§ Export My Data
                            </button>
                            <button onclick="managePreferences()" class="w-full p-3 rounded-xl font-semibold transition-colors hover:shadow-md text-left" style="background-color: #252B2B; color: #EFDFC5;">
                                üéõÔ∏è Preferences
                            </button>
                            <button onclick="logout()" class="w-full p-3 rounded-xl font-semibold transition-colors hover:shadow-md text-left" style="background-color: #8F0B13; color: #EFDFC5; border: 2px solid #380F17;">
                                üö™ Logout
                            </button>
                        </div>
                    </div>

                    <!-- Privacy & Security -->
                    <div class="backdrop-blur-sm rounded-3xl p-6" style="background-color: rgba(255, 255, 255, 0.9); border: 1px solid #380F17;">
                        <h3 class="text-xl font-bold mb-4 flex items-center" style="color: #380F17;">
                            <span class="mr-3 text-2xl">üõ°Ô∏è</span>
                            Privacy & Security
                        </h3>
                        <div class="space-y-4 text-sm">
                            <div class="flex items-center justify-between p-3 rounded-lg" style="background-color: rgba(124, 236, 134, 0.2);">
                                <div>
                                    <p class="font-semibold" style="color: #380F17;">Two-Factor Auth</p>
                                    <p class="text-xs" style="color: #4C4F54;">Extra security layer</p>
                                </div>
                                <span class="text-xs px-2 py-1 rounded-full" style="background-color: #7CEC86; color: white;">‚úì Enabled</span>
                            </div>
                            
                            <div class="flex items-center justify-between p-3 rounded-lg" style="background-color: rgba(239, 223, 197, 0.6);">
                                <div>
                                    <p class="font-semibold" style="color: #380F17;">Data Encryption</p>
                                    <p class="text-xs" style="color: #4C4F54;">All data encrypted</p>
                                </div>
                                <span class="text-xs px-2 py-1 rounded-full" style="background-color: #7CEC86; color: white;">‚úì Active</span>
                            </div>
                        </div>
                    </div>

                    <!-- ADHD Support -->
                    <div class="backdrop-blur-sm rounded-3xl p-6" style="background-color: rgba(56, 15, 23, 0.9); color: #EFDFC5;">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <span class="mr-3 text-2xl">üß†</span>
                            ADHD Journey
                        </h3>
                        <div class="text-sm leading-relaxed">
                            <p class="mb-3">üåü <strong>127 days</strong> of building ADHD-friendly financial habits!</p>
                            <p class="text-xs opacity-80 mb-4">Your brain has created new neural pathways for money management. That's incredible progress!</p>
                            <div class="space-y-2">
                                <div class="flex items-center justify-between">
                                    <span class="text-xs">Impulse Control</span>
                                    <span class="text-xs">92%</span>
                                </div>
                                <div class="w-full bg-gray-200 bg-opacity-30 rounded-full h-2">
                                    <div class="h-2 rounded-full" style="background-color: #EFDFC5; width: 92%;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="py-8 text-center animate-fadeIn">
        <div class="max-w-4xl mx-auto px-4">
            <p class="text-sm" style="color: #4C4F54;">
                BrainBudget - Making budgeting accessible | powered by <span class="font-semibold" style="color: #8F0B13;">Niostudio</span>
            </p>
        </div>
    </footer>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Load profile data
    loadProfileData();
    
    // Set up profile interactions
    setupProfileInteractions();
    
    function loadProfileData() {
        // Load user profile information
        fetch('/api/profile/info')
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    updateProfileDisplay(data.profile);
                }
            })
            .catch(error => {
                console.log('Using demo profile data');
            });
        
        // Load user achievements
        fetch('/api/profile/achievements')
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    updateAchievements(data.achievements);
                }
            })
            .catch(error => {
                console.log('Using demo achievement data');
            });
        
        // Load financial journey timeline
        fetch('/api/profile/timeline')
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    updateTimeline(data.timeline);
                }
            })
            .catch(error => {
                console.log('Using demo timeline data');
            });
    }
    
    function updateProfileDisplay(profile) {
        console.log('Profile data loaded:', profile);
    }
    
    function updateAchievements(achievements) {
        console.log('Achievements loaded:', achievements);
    }
    
    function updateTimeline(timeline) {
        console.log('Timeline loaded:', timeline);
    }
    
    function setupProfileInteractions() {
        // Add interactive elements
        const statCards = document.querySelectorAll('[style*="rgba(239, 223, 197, 0.6)"]');
        statCards.forEach(card => {
            card.addEventListener('mouseenter', () => {
                card.style.transform = 'scale(1.02)';
            });
            card.addEventListener('mouseleave', () => {
                card.style.transform = 'scale(1)';
            });
        });
    }
    
    // Profile action functions
    window.editProfile = function() {
        showSuccessToast('‚úèÔ∏è Profile editing coming soon! You\'ll be able to update your information and ADHD preferences.');
    };
    
    window.updatePassword = function() {
        showSuccessToast('üîê Password update feature coming soon! Enhanced security for your financial data.');
    };
    
    window.exportData = function() {
        showSuccessToast('üì§ Data export coming soon! Download all your BrainBudget data in a secure format.');
    };
    
    window.managePreferences = function() {
        showSuccessToast('üéõÔ∏è Advanced preferences coming soon! Fine-tune your ADHD-friendly experience.');
    };
    
    window.logout = async function() {
        const confirmed = await showConfirmModal({
            icon: 'üö™',
            title: 'Logout from BrainBudget',
            message: 'Are you sure you want to logout? Your progress will be saved and you can come back anytime!',
            cancelText: 'Stay Logged In',
            confirmText: 'Logout'
        });
        
        if (confirmed) {
            // Show logout toast
            showSuccessToast('üëã Logging out... Thanks for using BrainBudget! See you soon!');
            
            // Perform logout after a brief delay
            setTimeout(() => {
                // Make logout API call
                fetch('/auth/logout', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        // Redirect to landing page
                        window.location.href = data.redirect || '/';
                    } else {
                        // Fallback - redirect anyway
                        window.location.href = '/';
                    }
                })
                .catch(error => {
                    console.log('Logout request failed, redirecting anyway');
                    // Fallback - redirect to landing page
                    window.location.href = '/';
                });
            }, 1000);
        }
    };
    
    // ADHD-friendly entrance animations
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };
    
    const observer = new IntersectionObserver(function(entries) {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, observerOptions);
    
    // Observe profile cards for entrance animations
    document.querySelectorAll('.card-hover').forEach(card => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
        observer.observe(card);
    });
    
    // Achievement celebration effect
    const achievements = document.querySelectorAll('[style*="rgba(124, 236, 134, 0.2)"], [style*="rgba(255, 193, 7, 0.2)"], [style*="rgba(139, 92, 246, 0.2)"]');
    achievements.forEach((achievement, index) => {
        achievement.addEventListener('click', () => {
            showSuccessToast('üéâ Achievement unlocked! Your ADHD journey is inspiring!');
            // Add celebration animation
            achievement.style.animation = 'bounce 0.6s ease-out';
            setTimeout(() => {
                achievement.style.animation = '';
            }, 600);
        });
    });
    
    // Progress bar animation on load
    setTimeout(() => {
        const progressBars = document.querySelectorAll('[style*="width: 92%"]');
        progressBars.forEach((bar, index) => {
            bar.style.width = '0%';
            setTimeout(() => {
                bar.style.transition = 'width 2s ease-out';
                bar.style.width = '92%';
            }, index * 300 + 1000);
        });
    }, 500);
});
</script>
{% endblock %}