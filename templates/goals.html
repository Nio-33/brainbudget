{% extends "base.html" %}

{% block title %}Goals - BrainBudget{% endblock %}

{% block content %}
<!-- Goals Page -->
<div class="min-h-screen" style="background-color: #EFDFC5;">
    <!-- Navigation Header -->
    <header class="absolute top-4 left-4 right-4 z-10 animate-fadeIn">
        <div class="flex justify-between items-center">
            <div class="flex space-x-8">
                <a href="/home" class="flex items-center space-x-2 hover:opacity-80 transition-colors" style="color: #252B2B;">
                    <span>üè†</span>
                    <span>Home</span>
                </a>
            </div>
            <div class="flex items-center space-x-4">
                <!-- Navigation links removed - only on homepage -->
            </div>
        </div>
    </header>

    <!-- Header Section -->
    <div class="relative py-16 px-4">
        <div class="max-w-6xl mx-auto text-center">
            <div class="mb-6">
                <span class="text-6xl">üéØ</span>
            </div>
            <div class="inline-block px-8 py-4 rounded-full brain-gradient mb-6">
                <h1 class="text-4xl md:text-5xl font-bold text-white">
                    Goals
                </h1>
            </div>
            <p class="text-lg max-w-2xl mx-auto leading-relaxed" style="color: #252B2B;">
                Smart goal tracking with built-in celebration, accountability, and the flexibility to adapt when life happens.
            </p>
        </div>
    </div>

    <!-- Goals Content -->
    <div class="py-12 px-4">
        <div class="max-w-6xl mx-auto">
            <!-- Quick Actions Bar -->
            <div class="flex flex-wrap items-center justify-between mb-8 p-6 rounded-3xl" style="background-color: rgba(255, 255, 255, 0.9); border: 1px solid #380F17;">
                <div class="flex items-center space-x-4">
                    <h2 class="text-xl font-bold" style="color: #380F17;">Your Financial Goals</h2>
                    <span class="px-3 py-1 rounded-full text-sm font-semibold" style="background-color: #380F17; color: #EFDFC5;">3 Active</span>
                </div>
                <div class="flex space-x-3">
                    <button onclick="createNewGoal()" class="px-6 py-3 rounded-xl font-semibold transition-colors hover:shadow-md" style="background-color: #380F17; color: #EFDFC5;">
                        ‚ú® Create New Goal
                    </button>
                    <button onclick="showCelebrations()" class="px-6 py-3 rounded-xl font-semibold transition-colors hover:shadow-md" style="background-color: #8F0B13; color: #EFDFC5;">
                        üéâ Celebrations
                    </button>
                </div>
            </div>

            <!-- Active Goals Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <!-- Emergency Fund Goal -->
                <div class="backdrop-blur-sm rounded-3xl p-6 card-hover" style="background-color: rgba(255, 255, 255, 0.9); border: 1px solid #380F17;">
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 rounded-full flex items-center justify-center" style="background-color: rgba(56, 15, 23, 0.9);">
                                <span class="text-white text-xl">üèÜ</span>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold" style="color: #380F17;">Emergency Fund</h3>
                                <p class="text-sm" style="color: #4C4F54;">Target: $2,500 by March 2024</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-2xl font-bold" style="color: #8F0B13;">48%</div>
                            <div class="text-xs" style="color: #4C4F54;">$1,200 saved</div>
                        </div>
                    </div>
                    
                    <!-- Progress Bar -->
                    <div class="mb-4">
                        <div class="w-full bg-gray-200 rounded-full h-4">
                            <div class="h-4 rounded-full brain-gradient" style="width: 48%;"></div>
                        </div>
                        <div class="flex justify-between text-xs mt-2" style="color: #4C4F54;">
                            <span>$0</span>
                            <span>$1,300 remaining</span>
                            <span>$2,500</span>
                        </div>
                    </div>
                    
                    <!-- User-Friendly Features -->
                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-3 rounded-xl" style="background-color: rgba(124, 236, 134, 0.2);">
                            <span class="text-sm font-semibold" style="color: #380F17;">üéØ Monthly auto-save: $200</span>
                            <span class="text-xs" style="color: #4C4F54;">Next: Jan 1st</span>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="addToGoal('emergency')" class="flex-1 p-2 rounded-lg font-semibold transition-colors" style="background-color: #380F17; color: #EFDFC5;">
                                Add $50
                            </button>
                            <button onclick="celebrateProgress('emergency')" class="flex-1 p-2 rounded-lg font-semibold transition-colors" style="background-color: #8F0B13; color: #EFDFC5;">
                                üéâ Celebrate
                            </button>
                            <button onclick="adjustGoal('emergency')" class="p-2 rounded-lg font-semibold transition-colors" style="background-color: #4C4F54; color: #EFDFC5;">
                                ‚öôÔ∏è
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Vacation Fund Goal -->
                <div class="backdrop-blur-sm rounded-3xl p-6 card-hover" style="background-color: rgba(255, 255, 255, 0.9); border: 1px solid #380F17;">
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 rounded-full flex items-center justify-center" style="background-color: rgba(143, 11, 19, 0.9);">
                                <span class="text-white text-xl">‚úàÔ∏è</span>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold" style="color: #380F17;">Vacation Fund</h3>
                                <p class="text-sm" style="color: #4C4F54;">Target: $1,500 by June 2024</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-2xl font-bold" style="color: #8F0B13;">27%</div>
                            <div class="text-xs" style="color: #4C4F54;">$405 saved</div>
                        </div>
                    </div>
                    
                    <!-- Progress Bar -->
                    <div class="mb-4">
                        <div class="w-full bg-gray-200 rounded-full h-4">
                            <div class="h-4 rounded-full" style="background-color: #8F0B13; width: 27%;"></div>
                        </div>
                        <div class="flex justify-between text-xs mt-2" style="color: #4C4F54;">
                            <span>$0</span>
                            <span>$1,095 remaining</span>
                            <span>$1,500</span>
                        </div>
                    </div>
                    
                    <!-- User-Friendly Features -->
                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-3 rounded-xl" style="background-color: rgba(255, 193, 7, 0.2);">
                            <span class="text-sm font-semibold" style="color: #380F17;">üí° Weekly coffee fund redirect</span>
                            <span class="text-xs" style="color: #4C4F54;">$25/week</span>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="addToGoal('vacation')" class="flex-1 p-2 rounded-lg font-semibold transition-colors" style="background-color: #380F17; color: #EFDFC5;">
                                Add $25
                            </button>
                            <button onclick="celebrateProgress('vacation')" class="flex-1 p-2 rounded-lg font-semibold transition-colors" style="background-color: #8F0B13; color: #EFDFC5;">
                                üéâ Celebrate
                            </button>
                            <button onclick="adjustGoal('vacation')" class="p-2 rounded-lg font-semibold transition-colors" style="background-color: #4C4F54; color: #EFDFC5;">
                                ‚öôÔ∏è
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Left Column - Goal Progress Details -->
                <div class="lg:col-span-2 space-y-8">
                    <!-- Monthly Progress Chart -->
                    <div class="backdrop-blur-sm rounded-3xl p-6" style="background-color: rgba(255, 255, 255, 0.9); border: 1px solid #380F17;">
                        <h2 class="text-2xl font-bold mb-6 flex items-center" style="color: #380F17;">
                            <span class="mr-3 text-3xl">üìà</span>
                            Monthly Progress
                        </h2>
                        
                        <div class="space-y-4">
                            <!-- December Progress -->
                            <div class="p-4 rounded-2xl" style="background-color: rgba(239, 223, 197, 0.8);">
                                <div class="flex items-center justify-between mb-3">
                                    <h3 class="font-semibold" style="color: #380F17;">December 2024</h3>
                                    <span class="px-3 py-1 rounded-full text-sm font-semibold" style="background-color: #7CEC86; color: #380F17;">On Track</span>
                                </div>
                                <div class="grid grid-cols-2 gap-4 text-sm">
                                    <div>
                                        <p style="color: #4C4F54;">Emergency Fund: +$200</p>
                                        <p style="color: #4C4F54;">Vacation Fund: +$100</p>
                                    </div>
                                    <div>
                                        <p style="color: #4C4F54;">Total Progress: +$300</p>
                                        <p style="color: #4C4F54;">User Wins: üéâ 5 celebrations</p>
                                    </div>
                                </div>
                            </div>

                            <!-- November Progress -->
                            <div class="p-4 rounded-2xl" style="background-color: rgba(239, 223, 197, 0.8);">
                                <div class="flex items-center justify-between mb-3">
                                    <h3 class="font-semibold" style="color: #380F17;">November 2024</h3>
                                    <span class="px-3 py-1 rounded-full text-sm font-semibold" style="background-color: #7CEC86; color: #380F17;">Great!</span>
                                </div>
                                <div class="grid grid-cols-2 gap-4 text-sm">
                                    <div>
                                        <p style="color: #4C4F54;">Emergency Fund: +$250</p>
                                        <p style="color: #4C4F54;">Vacation Fund: +$75</p>
                                    </div>
                                    <div>
                                        <p style="color: #4C4F54;">Total Progress: +$325</p>
                                        <p style="color: #4C4F54;">Bonus: Found $50 in old account!</p>
                                    </div>
                                </div>
                            </div>

                            <!-- October Progress -->
                            <div class="p-4 rounded-2xl" style="background-color: rgba(255, 193, 7, 0.2);">
                                <div class="flex items-center justify-between mb-3">
                                    <h3 class="font-semibold" style="color: #380F17;">October 2024</h3>
                                    <span class="px-3 py-1 rounded-full text-sm font-semibold" style="background-color: #FFC107; color: #380F17;">Adjusted</span>
                                </div>
                                <div class="grid grid-cols-2 gap-4 text-sm">
                                    <div>
                                        <p style="color: #4C4F54;">Emergency Fund: +$150</p>
                                        <p style="color: #4C4F54;">Vacation Fund: +$50</p>
                                    </div>
                                    <div>
                                        <p style="color: #4C4F54;">Total Progress: +$200</p>
                                        <p style="color: #4C4F54;">Smart Moment: Adjusted goals ‚ú®</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Goal Achievement History -->
                    <div class="backdrop-blur-sm rounded-3xl p-6" style="background-color: rgba(255, 255, 255, 0.9); border: 1px solid #380F17;">
                        <h2 class="text-2xl font-bold mb-6 flex items-center" style="color: #380F17;">
                            <span class="mr-3 text-3xl">üèÜ</span>
                            Achievement History
                        </h2>
                        
                        <div class="space-y-4">
                            <!-- Completed Goal -->
                            <div class="flex items-center p-4 rounded-2xl" style="background-color: rgba(124, 236, 134, 0.2); border-left: 4px solid #7CEC86;">
                                <div class="w-12 h-12 rounded-full flex items-center justify-center mr-4" style="background-color: #7CEC86;">
                                    <span class="text-white text-xl">‚úÖ</span>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-semibold" style="color: #380F17;">Credit Card Payoff</h3>
                                    <p class="text-sm" style="color: #4C4F54;">Completed September 2024 ‚Ä¢ $2,500 goal</p>
                                </div>
                                <button onclick="viewGoalDetails('credit-card')" class="px-4 py-2 rounded-lg font-semibold transition-colors" style="background-color: #7CEC86; color: #380F17;">
                                    View Details
                                </button>
                            </div>

                            <!-- Another Completed Goal -->
                            <div class="flex items-center p-4 rounded-2xl" style="background-color: rgba(124, 236, 134, 0.2); border-left: 4px solid #7CEC86;">
                                <div class="w-12 h-12 rounded-full flex items-center justify-center mr-4" style="background-color: #7CEC86;">
                                    <span class="text-white text-xl">üíª</span>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-semibold" style="color: #380F17;">New Laptop Fund</h3>
                                    <p class="text-sm" style="color: #4C4F54;">Completed August 2024 ‚Ä¢ $1,200 goal</p>
                                </div>
                                <button onclick="viewGoalDetails('laptop')" class="px-4 py-2 rounded-lg font-semibold transition-colors" style="background-color: #7CEC86; color: #380F17;">
                                    View Details
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Sidebar -->
                <div class="space-y-6">
                    <!-- Support Tools -->
                    <div class="backdrop-blur-sm rounded-3xl p-6" style="background-color: rgba(255, 255, 255, 0.9); border: 1px solid #380F17;">
                        <h3 class="text-xl font-bold mb-4 flex items-center" style="color: #380F17;">
                            <span class="mr-3 text-2xl">üß†</span>
                            Support Tools
                        </h3>
                        <div class="space-y-3">
                            <button onclick="showFeature('body-doubling')" class="w-full p-3 rounded-xl font-semibold transition-colors hover:shadow-md text-left" style="background-color: #380F17; color: #EFDFC5;">
                                üë• Body Doubling Session
                            </button>
                            <button onclick="showFeature('dopamine-reward')" class="w-full p-3 rounded-xl font-semibold transition-colors hover:shadow-md text-left" style="background-color: #8F0B13; color: #EFDFC5;">
                                üéâ Dopamine Rewards
                            </button>
                            <button onclick="showFeature('executive-function')" class="w-full p-3 rounded-xl font-semibold transition-colors hover:shadow-md text-left" style="background-color: #252B2B; color: #EFDFC5;">
                                ‚ö° Executive Function Aids
                            </button>
                        </div>
                    </div>

                    <!-- Goal Templates -->
                    <div class="backdrop-blur-sm rounded-3xl p-6" style="background-color: rgba(255, 255, 255, 0.9); border: 1px solid #380F17;">
                        <h3 class="text-xl font-bold mb-4 flex items-center" style="color: #380F17;">
                            <span class="mr-3 text-2xl">üìã</span>
                            Quick Start Templates
                        </h3>
                        <div class="space-y-3 text-sm">
                            <div class="flex items-center justify-between p-3 rounded-xl cursor-pointer hover:shadow-md transition-colors" style="background-color: rgba(239, 223, 197, 0.6);">
                                <div>
                                    <h4 class="font-semibold" style="color: #380F17;">Emergency Fund</h4>
                                    <p style="color: #4C4F54;">$1,000 - $5,000</p>
                                </div>
                                <span class="text-xl">üè•</span>
                            </div>
                            <div class="flex items-center justify-between p-3 rounded-xl cursor-pointer hover:shadow-md transition-colors" style="background-color: rgba(239, 223, 197, 0.6);">
                                <div>
                                    <h4 class="font-semibold" style="color: #380F17;">Debt Payoff</h4>
                                    <p style="color: #4C4F54;">Snowball or avalanche</p>
                                </div>
                                <span class="text-xl">üí≥</span>
                            </div>
                            <div class="flex items-center justify-between p-3 rounded-xl cursor-pointer hover:shadow-md transition-colors" style="background-color: rgba(239, 223, 197, 0.6);">
                                <div>
                                    <h4 class="font-semibold" style="color: #380F17;">Fun Goal</h4>
                                    <p style="color: #4C4F54;">Hyperfocus-friendly</p>
                                </div>
                                <span class="text-xl">üéØ</span>
                            </div>
                        </div>
                    </div>

                    <!-- Weekly Motivation -->
                    <div class="backdrop-blur-sm rounded-3xl p-6" style="background-color: rgba(56, 15, 23, 0.9); color: #EFDFC5;">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <span class="mr-3 text-2xl">üí™</span>
                            Weekly Motivation
                        </h3>
                        <div class="text-sm leading-relaxed">
                            <p class="mb-3">üåü <strong>You're doing amazing!</strong> You've made progress on your goals every week this month.</p>
                            <p class="text-xs opacity-80">Remember: Your brain is wired for interest, not importance. That's why we make goals fun and flexible!</p>
                            <button class="mt-3 px-4 py-2 rounded-lg font-semibold transition-colors" style="background-color: #EFDFC5; color: #380F17;">
                                Share Progress
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="py-8 text-center animate-fadeIn">
        <div class="max-w-4xl mx-auto px-4">
            <p class="text-sm" style="color: #4C4F54;">
                BrainBudget - Making budgeting accessible | powered by <span class="font-semibold" style="color: #8F0B13;">Niostudio</span>
            </p>
        </div>
    </footer>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Load goals data
    loadGoals();
    
    // Auto-refresh goals every 10 minutes
    setInterval(loadGoals, 600000);
    
    function loadGoals() {
        // Load active goals
        fetch('/api/goals/active')
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    updateGoalsDisplay(data.goals);
                }
            })
            .catch(error => {
                console.log('Using demo goals data');
            });
        
        // Load goal progress history
        fetch('/api/goals/progress')
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    updateProgressHistory(data.progress);
                }
            })
            .catch(error => {
                console.log('Using demo progress data');
            });
    }
    
    function updateGoalsDisplay(goals) {
        console.log('Goals loaded:', goals);
    }
    
    function updateProgressHistory(progress) {
        console.log('Progress history loaded:', progress);
    }
    
    // Goal management functions
    window.createNewGoal = function() {
        showSuccessToast('üéØ Goal creation wizard coming soon! This will help you break big goals into manageable small steps.');
    };
    
    window.addToGoal = function(goalId) {
        showSuccessToast(`üí∞ Added to ${goalId} goal! Your progress is building momentum!`);
        // Animate progress bar update
        setTimeout(() => {
            updateProgressAnimation(goalId);
        }, 500);
    };
    
    window.celebrateProgress = function(goalId) {
        showSuccessToast('üéâ Celebration time! Your brain loves these dopamine rewards!');
        // Trigger celebration animation
        triggerCelebration();
    };
    
    window.adjustGoal = function(goalId) {
        showSuccessToast('‚öôÔ∏è Goal adjustment panel coming soon! Flexibility is key for success.');
    };
    
    window.showCelebrations = function() {
        showSuccessToast('üéä Celebration center coming soon! A dedicated space for all your wins and milestones!');
    };
    
    window.viewGoalDetails = function(goalId) {
        showSuccessToast(`üìä Detailed view for ${goalId} goal coming soon! See your complete journey and insights.`);
    };
    
    function updateProgressAnimation(goalId) {
        // Find progress bars and animate them
        const progressBars = document.querySelectorAll('.brain-gradient, [style*="background-color: #8F0B13"]');
        progressBars.forEach(bar => {
            bar.style.transform = 'scaleX(1.02)';
            setTimeout(() => {
                bar.style.transform = 'scaleX(1)';
            }, 300);
        });
    }
    
    function triggerCelebration() {
        // Create celebration effect
        const celebration = document.createElement('div');
        celebration.innerHTML = 'üéâ‚ú®üéä';
        celebration.style.position = 'fixed';
        celebration.style.top = '50%';
        celebration.style.left = '50%';
        celebration.style.transform = 'translate(-50%, -50%)';
        celebration.style.fontSize = '3rem';
        celebration.style.zIndex = '9999';
        celebration.style.pointerEvents = 'none';
        celebration.style.animation = 'bounce 1s ease-out';
        
        document.body.appendChild(celebration);
        
        setTimeout(() => {
            document.body.removeChild(celebration);
        }, 1000);
    }
    
    // Feature placeholders
    window.showFeature = function(feature) {
        const features = {
            'body-doubling': 'üë• Body doubling sessions coming soon! Work on your goals with virtual accountability partners.',
            'dopamine-reward': 'üéâ Dopamine reward system coming soon! Gamify your progress with engaging celebrations.',
            'executive-function': '‚ö° Executive function aids coming soon! Step-by-step guidance and reminders for goal success.'
        };
        
        if (features[feature]) {
            showSuccessToast(features[feature]);
        }
    };
    
    // User-friendly entrance animations
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };
    
    const observer = new IntersectionObserver(function(entries) {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, observerOptions);
    
    // Observe cards for entrance animations
    document.querySelectorAll('.card-hover').forEach(card => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
        observer.observe(card);
    });
    
    // Progress bar animations on page load
    setTimeout(() => {
        const progressBars = document.querySelectorAll('.brain-gradient, [style*="background-color: #8F0B13"]');
        progressBars.forEach((bar, index) => {
            bar.style.width = '0%';
            setTimeout(() => {
                bar.style.transition = 'width 1s ease-out';
                bar.style.width = bar.getAttribute('data-width') || bar.style.width;
            }, index * 200);
        });
    }, 500);
});
</script>
{% endblock %}